{% load humanize %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="pdf-search engine for IOE contents. Search from over 50,000 files">
    <title>Search Results</title>
    <link rel="stylesheet" href="styles.css">

    <style>
        a {
            text-decoration: none !important;
            color: inherit !important;
            cursor: default;
        }

        body {
        font-family: Arial, sans-serif;
        }

        .search-container {
            text-align: center;
            margin-bottom: 20px;
        }

        input[type="text"] {
            padding: 10px;
            width: 300px;
        }
        .search-input{
            border-radius: 5px;
            font-weight: bold;
        }
        .search-button {
            padding: 10px 20px;
            background-color: #333;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
        }
    
        .result {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px;
            display: flex;
            align-items: center;
        }
    
        .icon {
            margin-right: 20px;
        }
    
        .icon img {
            max-width: 50px;
            max-height: 50px;
        }
    
        .details {
            flex-grow: 1;
        }

        .title{
            cursor: pointer;/* show pointer on hover */
        }
    
        button {
            background-color: #007BFF;
            color: #fff;
            border: none;
            padding: 5px 10px;
            margin: 5px;
            cursor: pointer;
        }
    
    </style>
    <style>

        .code-share-button {
          position: relative;
          display: inline-block;
          padding: 10px 20px;
          background-color: #333;
          color: #00ff00;
          text-decoration: none;
          font-family: 'Arial', sans-serif;
          font-size: 18px;
          font-weight: bold;
          border: none;
          border-radius: 5px;
          overflow: hidden;
          cursor: pointer;
        }
    
        .code-share-button::after {
          content: '|';
          position: absolute;
          top: 50%;
          right: 10px;
          transform: translateY(-50%);
          color: #00ff00;
          animation: blinkCursor 0.8s infinite;
        }
    
        @keyframes blinkCursor {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0;
          }
        }
    </style>
    
    <!-- Footer-Style -->
    <style>
            {% if search_result %}
                footer {
                    background-color: #333;
                    color: #fff;
                    text-align: center;
                    padding: 20px;
                    position: relative !important;
                    bottom: 0 !important;
                    width: 100%;
                    /* make the footer attach to the bottom of the page */
                    left: 0;
                    bottom: 0;
                    width: 100%;
                }
            {% else %}
                footer {
                    background-color: #333;
                    color: #fff;
                    text-align: center;
                    padding: 20px;
                    position: fixed !important;
                    bottom: 0 !important;
                    width: 100%;
                    /* make the footer attach to the bottom of the page */
                    left: 0;
                    bottom: 0;
                    width: 100%;
                }
            {% endif %}
    
            footer hr {
                border: 1px solid #fff;
                margin: 10px 0;
            }
    
            .contact-info {
                display: flex;
                justify-content: center;
                align-items: center;
                margin-top: 10px;
                font-weight: bold;
            }
    
            .contact-info a {
                color: #fff;
                text-decoration: none;
                margin: 0 10px;
                
            }

            .follow-links{
                /* light-blue, underlined texts, bold text */
                /* color: rgb(0, 255, 76) !important; */
                text-decoration: underline !important;
                font-weight: bold;
                cursor: pointer;
                margin-right: 3px;
                margin-left: 3px;
            }
    </style>
</head>

<body>
    <!-- Bootstrap-5 css-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    
    <div class="d-flex justify-content-center mb-3">
        <a href="/" targer="_blank" style="text-decoration: none; color:white;">
            <button class="code-share-button mt-3" target="_blank">
                Code-Share
            </button>
        </a>
    </div>

    <div class="alert alert-info alert-dismissible fade show" role="alert" id="welcome">
        It is <strong>Pdf Search Engine</strong> 
        <strong> for IOE Students. </strong>
        As of today we have <span id="counter" style="font-weight: 500;">{{documents_count|intcomma}}</span> documents. Good Luck For the Exams and don't forget to bookmark and share the love!
    </div>

    <div class="search-container">
        <form action="" method="get" id="/pdf">
            <input type="text" class="search-input" name="search" placeholder="{{query}}">
            <button class="search-button" type="submit">Search</button><br>
            
            <input type="checkbox" id="deep-search" class="mt-3" name="deep_search">
            <label for="deep-search">Deep-Search: Search Individual words of a multi-word query</label>
        </form>
    </div>


    {% for file in search_result %}
        <div class="result">
            <div class="icon">
                {% if file.mimeType == "application/vnd.google-apps.shortcut" or  file.mimeType == "application/vnd.google-apps.folder"%}
                    <svg focusable="false" viewBox="0 0 24 24" height="24px" width="24px" fill="#5f6368" class="a-s-fa-Ha-pa"><g><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"></path><path d="M0 0h24v24H0z" fill="none"></path></g></svg>
                {% else %}
                
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24px" width="24px" fill="#5f6368" class="a-s-fa-Ha-pa">
                        <path d="M3 2c-.55 0-1 .45-1 1v18c0 .55.45 1 1 1h18c.55 0 1-.45 1-1V8c0-.55-.45-1-1-1h-7V2H3zm4 16H3v-6h4v6zm0-8H3V4h4v6zm14 10H7c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2z"></path>
                        <path d="M0 0h24v24H0z" fill="none"></path>
                    </svg>
                {%endif%}
            </div>
            <div class="details">
                {% if file.mimeType == "application/vnd.google-apps.shortcut" or  file.mimeType == "application/vnd.google-apps.folder"%}
                    <a target="_blank" href="https://drive.google.com/drive/folders/{{file.id}}">
                        <h3 class="title">{{file.title}}</h3>
                    </a>
                {% else %}
                    <a target="_blank" href="https://drive.google.com/file/d/{{file.id}}/view?usp=drivesdk">
                        <h3 class="title">{{file.title}}</h3>
                    </a>
                {% endif %}
                <p>Size: <span class="quotaBytesUsed" quotaBytesUsed="{{ file.quotaBytesUsed }}"></span> MB</p>
                <p>Owner: <span> {{file.owners.0.displayName}} </span></p>
                {% if file.mimeType == "application/vnd.google-apps.shortcut" or  file.mimeType == "application/vnd.google-apps.folder"%}
                    <button class="download-btn"><a target="_blank" href="https://drive.google.com/drive/folders/{{file.id}}">Open</a></button>
                {% else %}
                    <button class="download-btn"><a target="_blank" href="https://drive.usercontent.google.com/download?id={{file.id}}&export=download&confirm=t">Download</a></button>
                    <button class="download-btn"><a target="_blank" href="https://drive.google.com/file/d/{{file.id}}/view?usp=drivesdk">Open</a></button>    
                {%endif%}
            </div>
            
        </div>
    {%endfor%}
    {% if not search_result %}
        <h1>No results found</h1>
        <h6>Note: Minimum query-length is 3</h6>
    {%endif%}
<script>
    function updateQuotaBytesUsed() {
    const spans = document.querySelectorAll('.quotaBytesUsed');
    for (const span of spans) {
        const productId = parseInt(span.getAttribute('quotaBytesUsed'));
        console.log(productId);
        const newQuotaBytesUsed = productId / 1048576;
        span.textContent = newQuotaBytesUsed.toFixed(2);
    }
    }
    updateQuotaBytesUsed();

</script>
<footer>
    <p class="contact-info">Contact Information</p>
    <hr>
    <a href="https://discord.gg/dgCDNgRfxE" class="follow-links me-3" target="_blank">
        <svg stroke="currentColor" fill="white" stroke-width="0" viewBox="0 0 640 512" class="text-indigo-500 text-3xl" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"></path></svg>
        Discord
    </a>
    <a href="mailto:aanandaprashadgiri@gmail.com, shrestharitik@gmail.com" class="ms-3 follow-links">
        Mail
    </a>
</footer>
</body>
</html>
